<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Real-Time Bitcoin Tracker</title>
<style>
html, body {
  margin: 0; padding: 0;
  width: 100%; height: 100%;
  background: #0a0f1a; color: #fff;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  overflow: hidden;
}
body { display: flex; justify-content: center; align-items: center; }

.container {
  width: calc(100vw - 100px);
  height: calc(100vh - 100px);
  display: flex; flex-direction: column;
  gap: 2vh; padding: 2vh 2vw;
}

/* --- TOP PLATE --- */
.top-plate {
  background: linear-gradient(to bottom, #0f1526, #121b2f);
  border-radius: 0.5vw;
  padding: 2vh 2vw;
  display: flex; justify-content: space-between; align-items: center;
  border: 1px solid #1e2a44;
}

.top-left { display: flex; flex-direction: column; }

/* === NEW SLIDER AREA === */
.top-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 1vh;
}
.slider-label { font-size: 0.9vw; color: #a0aec0; margin-bottom: 0.3vh; }
.range-select {
  width: 10vw;
  -webkit-appearance: none;
  height: 0.6vw;
  background: #1e2a44;
  border-radius: 1vw;
  outline: none;
}
.range-select::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 1vw; height: 1vw;
  border-radius: 50%;
  background: #22c55e;
  cursor: pointer;
}
.range-select::-moz-range-thumb {
  width: 1vw; height: 1vw; border-radius: 50%;
  background: #22c55e; cursor: pointer;
}
/* ======================= */

.title { font-size: 2.5vw; font-weight: 700; }
.subtitle { color: #a0aec0; font-size: 1vw; }
.price { font-size: 3vw; font-weight: 800; }
.change {
  margin-top: 1vh;
  background-color: rgba(16,185,129,0.35);
  color: #6ee7b7;
  padding: 0.5vh 1vw;
  border-radius: 1vw;
}
.change.down { background-color: rgba(239,68,68,0.35); color: #f87171; }

.stat-card {
  flex: 1; background: #0a0f1a;
  border-radius: 0.5vw; padding: 1.5vh 1.5vw;
  border: 1px solid #1e2a44;
}

.chart-container {
  background: #0a0f1a;
  border-radius: 0.5vw;
  padding: 2vh 2vw;
  flex-grow: 1;
  border: 1px solid #1e2a44;
}
#priceChart { width: 100% !important; height: 100% !important; }

</style>
</head>
<body>

<div class="container">

  <div class="top-plate">
    <div class="top-left">
      <div class="title">Bitcoin</div>
      <div class="subtitle">BTC/USDT</div>
      <div class="price" id="currentPrice">$--.--</div>
      <div class="change" id="priceChange">
        <span class="arrow" id="changeArrow">↑</span>
        <span id="changePercent">0.00%</span> 24h
      </div>
    </div>

    <!-- ⭐ NEW SLIDER -->
    <div class="top-right">
      <div class="slider-label">View Range</div>
      <input type="range" min="0" max="4" value="0" class="range-select" id="rangeSelect">
      <div id="rangeLabel" style="font-size:0.9vw;color:#a0aec0;">Real-Time</div>
    </div>
  </div>

  <div class="stats-row">
    <div class="stat-card">
      <div class="stat-title">24h High</div>
      <div class="stat-value high" id="high24h">$--.--</div>
    </div>

    <div class="stat-card">
      <div class="stat-title">24h Low</div>
      <div class="stat-value low" id="low24h">$--.--</div>
    </div>

    <div class="stat-card">
      <div class="stat-title">Market Cap</div>
      <div class="stat-value cap" id="marketCap">$--.--B</div>
    </div>
  </div>

  <div class="chart-container">
    <canvas id="priceChart"></canvas>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
/* =============== EXISTING VARIABLES =============== */
let priceChart;
let priceData = [];
let timeLabels = [];
let lastUpdate = 0;
const updateInterval = 500;
let ws = null;
let lastPrice = null;

const currentPriceEl = document.getElementById('currentPrice');
const priceChangeEl = document.getElementById('priceChange');
const changeArrowEl = document.getElementById('changeArrow');
const changePercentEl = document.getElementById('changePercent');

/* ============= SLIDER LOGIC (NEW) ============= */
const rangeSelect = document.getElementById("rangeSelect");
const rangeLabel = document.getElementById("rangeLabel");

const modes = ["Real-Time", "1H", "1D", "1M", "1Y"];
const intervals = {
  "1H":  { interval:"1m",  limit:60 },
  "1D":  { interval:"15m", limit:96 },
  "1M":  { interval:"4h",  limit:180 },
  "1Y":  { interval:"1d",  limit:365 }
};

rangeSelect.addEventListener("input", () => {
  const mode = modes[rangeSelect.value];
  rangeLabel.textContent = mode;

  if (mode === "Real-Time") {
    startRealTime();
  } else {
    stopRealTime();
    loadHistorical(mode);
  }
});

/* ============= REAL-TIME MODE ============= */
function startRealTime() {
  if (ws) ws.close();
  ws = new WebSocket("wss://stream.binance.com:9443/ws/btcusdt@trade");

  ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    const currentPrice = parseFloat(data.p);
    const now = new Date();
    const label = now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit',second:'2-digit'});

    const nowMs = Date.now();
    if (nowMs - lastUpdate < updateInterval) return;
    lastUpdate = nowMs;

    priceData.push(currentPrice);
    timeLabels.push(label);
    if (priceData.length > 1000) { priceData.shift(); timeLabels.shift(); }

    updateChart();

    currentPriceEl.textContent = `$${currentPrice.toLocaleString()}`;
    if (lastPrice !== null) {
      const diff = ((currentPrice - lastPrice) / lastPrice) * 100;
      changeArrowEl.textContent = diff >= 0 ? "↑" : "↓";
      changePercentEl.textContent = Math.abs(diff).toFixed(2) + "%";
      priceChangeEl.className = diff >= 0 ? "change" : "change down";
    }
    lastPrice = currentPrice;
  };
}

/* ============= HISTORICAL MODE ============= */
async function loadHistorical(mode) {
  priceData = [];
  timeLabels = [];

  const cfg = intervals[mode];
  const url = `https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=${cfg.interval}&limit=${cfg.limit}`;

  const res = await fetch(url);
  const data = await res.json();

  data.forEach(candle => {
    const price = parseFloat(candle[4]);
    const time = new Date(candle[0]).toLocaleDateString();
    priceData.push(price);
    timeLabels.push(time);
  });

  updateChart();
}

/* ============= CHART SETUP ============= */
const ctx = document.getElementById("priceChart").getContext("2d");
priceChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: timeLabels,
    datasets: [{
      label: "BTC/USDT",
      data: priceData,
      borderColor: "#22c55e",
      backgroundColor: "rgba(34,197,94,0.3)",
      fill: true,
      tension: 0.4,
      pointRadius: 0
    }]
  },
  options: {
    animation: false,
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      x: { ticks: { color:"#94a3b8" }, grid:{ display:false }},
      y: { ticks: { color:"#94a3b8" }, grid:{ color:"rgba(147,197,253,0.1)" }}
    },
    plugins: { legend:{ display:false } }
  }
});

function updateChart() {
  priceChart.data.labels = timeLabels;
  priceChart.data.datasets[0].data = priceData;
  priceChart.update("none");
}

function stopRealTime() {
  if (ws) { ws.close(); ws = null; }
}

/* Start in real-time mode */
startRealTime();
</script>

</body>
</html>
